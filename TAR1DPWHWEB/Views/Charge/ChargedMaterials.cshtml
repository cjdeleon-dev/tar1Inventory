@model IPagedList<TAR1DPWHDATA.DataModels.ChargeMaterialHeaderModel>

@{
    ViewBag.Title = "Charged Materials";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

@using PagedList;
@using PagedList.Mvc;

<script src="~/Scripts/myscripts/adminchargescripts_v1.1.6.js"></script>

@*<link href="~/Content/mystyles/mydatatable.css" rel="stylesheet" />*@
@*<link href="~/Content/PagedList.css" rel="stylesheet" />
    <link href="~/Content/font-awesome.min.css" rel="stylesheet" />*@

<h4>Charged Materials</h4>


<div class="row">
    <div class="col-lg-6">
        <button type="button" class="btn btn-primary" data-toggle="modal"
                onclick="return initDefaultFields();">
            New Material Charge Ticket
        </button>
        <button type="button" class="btn btn-success" data-toggle="modal" 
                onclick="return showExportModal();">Show Data Export Options</button>
    </div>
</div>

<div class="row">
    <div class="col-md-7">
        <div class="table-responsive-sm">
            <table class="table table-striped table-bordered table-hover" id="myTable1">
                <thead bgcolor="lightblue">
                    <tr>
                        <th>
                            ID
                        </th>
                        <th>
                            Posted Date
                        </th>
                        <th>
                            Posted By
                        </th>
                        <th>
                            Project
                        </th>
                        <th>
                            JO/WO/MO
                        </th>
                        <th>
                            Number
                        </th>
                        <th>
                            Received By
                        </th>
                        <th>
                            Action
                        </th>
                    </tr>
                </thead>
            </table>
        </div>

    </div>
    <div class="col-md-5">
        <table class="table table-bordered table-hover" id="myTable2">
            <thead bgcolor="lightblue">
                <tr>
                    <th>
                        Material
                    </th>
                    <th style="text-align:center;">
                        Qty
                    </th>
                    <th style="text-align:center;">
                        Unit
                    </th>
                    <th>
                        Serial No.
                    </th>
                </tr>
            </thead>
        </table>
    </div>
</div>


@*Charge Material Modal------------------------------------------------------------------------*@
<div class="modal fade" id="myModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row">
                    <div class="col-md-8">
                        <h4 class="modal-title" id="myModalLabel">Charging Material</h4>
                    </div>
                    <div class="col-md-2 col-md-push-1">
                        <p>
                            <button type="button" class="btn btn-primary" id="btnAddChargedMat" onclick="addChargedMaterials();">Save</button>
                        </p>
                    </div>
                    <div class="col-md-2">
                        <p>
                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                        </p>
                    </div>
                </div>
            </div>
            <div class="modal-body small">
                <form name="myform">
                    <div class="form-group">
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-3">
                                    <input type="hidden" class="form-control" id="Id" placeholder="Id" disabled="disabled" />
                                    <label for="PostedDate">Date: </label>
                                    <input type="date" class="form-control" id="PostedDate" style="min-width: 100%" onkeypress="dtpOnKeyPress(event);" />
                                </div>
                                <div class="col-md-9">
                                    <input type="hidden" class="form-control" id="PostedById" placeholder="Id" disabled="disabled" />
                                    <label for="PostedBy">Posted By: </label>
                                    <input type="text" class="form-control" id="PostedBy" placeholder="Posted By" style="min-width: 100%" disabled="disabled" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-7">
                                    <label for="Project">Project: </label>
                                    <input type="text" class="form-control" id="Project" placeholder="Project" style="min-width: 100%" />
                                </div>
                                <div class="col-md-5">
                                    <label for="ProjectAddress">Project Address: </label>
                                    <input type="text" class="form-control" id="ProjectAddress" placeholder="Project Address" style="min-width: 100%" />
                                </div>
                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-xs-6">
                                    <input type="hidden" class="form-control" id="IssuedById" />
                                    <label for="IssuedBy">Issued By: </label>
                                    <select id="IssuedBy" class="form-control select2 select2-hidden-accessible" onchange="return cboSig1OnChange();" style="min-width: 100%"></select>
                                </div>
                                <div class="col-xs-6">
                                    <input type="hidden" class="form-control" id="ReceivedById" />
                                    <input type="checkbox" id="isConsumer" onclick="onChangeCheckBox();" />
                                    <label for="ReceivedBy"> Is Consumer Received By: </label>
                                    <select id="ReceivedBy" class="form-control select2 select2-hidden-accessible" onchange="return cboRecOnChange();" style="min-width: 100%"></select>
                                    <input type="text" id="ConsumerReceivedBy" class="form-control" style="min-width:100%;" placeholder="Consumer's Name" />
                                </div>
                            </div>
                        </div>
                        <hr />
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-8">
                                    <input type="hidden" class="form-control" id="JOWOMOId" disabled="disabled" />
                                    <label for="JOWOMO">JO/WO/MO: </label>
                                    <select id="JOWOMO" class="form-control select2 select2-hidden-accessible" onchange="return cboJOWOMOOnChange();" style="min-width: 100%"></select>
                                </div>
                                <div class="col-md-3">
                                    <label for="JOWOMO">Number: </label>
                                    <input type="text" class="form-control" id="JOWOMONumber" placeholder="JO/WO/MO Number" style="min-width: 100%" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-10">
                                    <input type="hidden" class="form-control" id="MaterialId" />
                                    <label for="Material">Select Material: </label>
                                    <select id="Material" name="cbomaterial" class="form-control select2 select2-hidden-accessible" onchange="return cboMaterialOnChange();" style="min-width: 100%"></select>
                                </div>
                                <div class="col-md-2" style="text-align:center;">
                                    <input type="hidden" class="form-control" id="UnitId" />
                                    <label for="Unit">Unit </label>
                                    <input type="text" class="form-control" id="Unit" style="min-width: 100%; text-align:center;" disabled="disabled" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-5" style="text-align:center;">
                                    <label for="SerialNo">Serial Number: </label>
                                    <input type="text" class="form-control" id="SerialNo" name="txtserialno" onkeypress="return txtSerialOnKeyPress(event)" style="min-width: 100%; text-align:right;" />
                                </div>
                                <div class="col-md-2" style="text-align:center;">
                                    <label for="OnHand">On Hand </label>
                                    <input type="text" class="form-control" id="OnHand" style="min-width: 100%; text-align:center;" disabled="disabled" />
                                </div>
                                <div class="col-md-3" style="text-align:center;">
                                    <label for="Quantity">QTY </label>
                                    <input type="text" class="form-control" id="Quantity" name="txtquantity" style="min-width: 100%; text-align:center;" onkeypress="return isNumber(event)" placeholder="0" />
                                </div>
                                <div class="col-md-2" style="padding-top:22px;">
                                    <button type="button" class="btn btn-success" id="btnAddMaterialItem" onclick="addMaterialItem();">Add Material</button>
                                </div>
                            </div>
                            <hr />
                            <table class="table table-striped table-bordered table-hover" id="tblMDetails" style="padding-left:10px;padding-right:10px;">
                                <thead bgcolor="lightblue">
                                    <tr>
                                        <th style="text-align:center;display:none;">
                                            MaterialId
                                        </th>
                                        <th style="text-align:center;">
                                            Material
                                        </th>
                                        <th style="text-align:center;display:none;">
                                            UnitId
                                        </th>
                                        <th style="text-align:center;">
                                            Unit
                                        </th>
                                        <th style="text-align:center;">
                                            Quantity
                                        </th>
                                        <th style="text-align:center;">
                                            Serial No
                                        </th>
                                        <th style="text-align:center;display:none;">
                                            JOWOMO Id
                                        </th>
                                        <th style="text-align:center;">
                                            Code
                                        </th>
                                        <th style="text-align:center;">
                                            Number
                                        </th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody class="tbodydetail"></tbody>
                            </table>
                            <div class="row">
                                <div class="col-xs-4">
                                    <input type="hidden" class="form-control" id="CheckedById" />
                                    <label for="CheckedBy" style="visibility:hidden;">Checked By: </label>
                                    <select id="CheckedBy" style="visibility:hidden;" class="form-control select2 select2-hidden-accessible" onchange="return cboSig4OnChange();" style="min-width: 100%"></select>
                                </div>
                                <div class="col-xs-4">
                                    <input type="hidden" class="form-control" id="NotedById" />
                                    <label for="NotedBy" style="visibility:hidden;">Noted By: </label>
                                    <select id="NotedBy" style="visibility:hidden;" class="form-control select2 select2-hidden-accessible" onchange="return cboSig2OnChange();" style="min-width: 100%"></select>
                                </div>
                                <div class="col-xs-4">
                                    <input type="hidden" class="form-control" id="AuditedById" />
                                    <label for="AuditedBy" style="visibility:hidden;">Audited By: </label>
                                    <select id="AuditedBy" style="visibility:hidden;" class="form-control select2 select2-hidden-accessible" onchange="return cboSig3OnChange();" style="min-width: 100%"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@*End of Charge Material Modal-----------------------------------------------------------------*@
@*REPORT VIEWER*@
<div class="modal fade" id="myRptModal" tabindex="-1" role="dialog" aria-labelledby="myRptModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" onclick="@Url.Action("ChargedMaterials","Charge")">X</button>
                <h4 class="modal-title" id="myRptModalLabel">Material Charge Ticket</h4>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <embed src="" width="100%" height="500" type="application/pdf" id="mctpdf" />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
@*END OF REPORT VIEWER*@

@*EXPORT DATA MODAL*@
<div class="modal fade" id="myExportModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="myExportModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" style="overflow-y: initial !important; width:1250px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">X</button>
                <h4 class="modal-title" id="myExportModalLabel">EXPORT DATA BY DATE RANGE</h4>
            </div>
            <div class="modal-body" style="max-height: calc(100vh - 200px); overflow-y: auto; ">
                @* DATE SELECTION HERE AND FETCH BUTTON *@
                <div class="row">
                    <div class="col-md-3">
                        <label>DATE FROM:</label>
                        <input type="date" class="form-control" id="dtpDateFr" />
                    </div>
                    <div class="col-md-3">
                        <label>DATE TO:</label>
                        <input type="date" class="form-control" id="dtpDateTo" />
                    </div>
                    <div class="col-md-4" style="padding-top:1.8em;">
                        <button type="button" class="btn btn-info" onclick="fetchdata();">
                            <span><i class="glyphicon glyphicon-play">FETCH DATA</i></span>
                        </button>
                    </div>
                </div>
                <hr />
                @* TABLE HERE *@
                <div class="row">
                    <div class="table-responsive-sm">
                        <table class"table table-striped table-bordered table-hover" id="tblExport">
                            <thead>
                                <tr>
                                    <th>MaterialId</th>
                                    <th>StockName</th>
                                    <th>Description</th>
                                    <th>SerialNo</th>
                                    <th>PostedDate</th>
                                    <th>MCTNo</th>
                                    <th>Unit</th>
                                    <th>Qty</th>
                                    <th>UCost</th>
                                    <th>TCost</th>
                                    <th>WOCode</th>
                                    <th>WOAccnt</th>
                                    <th>WONo</th>
                                    <th>Project</th>
                                    <th>Address</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" onclick="closeExportModal()">Close</button>
            </div>
        </div>
    </div>
</div>

@*END OF EXPORT DATA MODAL*@

@*<div class="modal fade" id="modalLoading" data-backdrop="static" data-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered justify-content-center" role="document">
        <div class="spin-container">
            <div class="spin" id="loader"></div>
            <div class="spin" id="loader2"></div>
            <div class="spin" id="loader3"></div>
            <div class="spin" id="loader4"></div>
            <span id="spintext">LOADING...</span>
        </div>

    </div>
</div>*@

<div class="modal fade" id="modalLoading" data-backdrop="static" data-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="spin-container">
            <div class="spin" id="loader"></div>
            <div class="spin" id="loader2"></div>
            <div class="spin" id="loader3"></div>
            <div class="spin" id="loader4"></div>
            <span id="spintext">LOADING...</span>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#lblFrom').hide();
            $('#lblTo').hide();
            $('#dtpFrom').hide();
            $('#dtpTo').hide();
            $('#btnExport').hide();

            loadAllMCTHeaders();

        });
    </script>
}
